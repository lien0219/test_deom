<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ËØ≠Èü≥ËΩ¨ÊñáÂ≠ó</title>
  </head>
  <body>
    <div>
      <textarea
        name="ËØ≠Èü≥ËΩ¨ÊñáÂ≠óÂÜÖÂÆπÂå∫"
        id="area"
        cols="30"
        rows="10"
        placeholder="ËØ¥ÁÇπ‰ªÄ‰πàÂêß..."
      ></textarea>
      <div>
        <button id="speekButton">üé§</button>
        <p id="addTextButton">ÂèëÂ∏É</p>
      </div>
      <ul id="list" style="display: none"></ul>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const area = document.getElementById("area");
        const speekButton = document.getElementById("speekButton");
        const addTextButton = document.getElementById("addTextButton");
        const list = document.getElementById("list");
        let textInp = "";
        let isGoing = false;
        let recognition = new webkitSpeechRecognition();
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = "zh-CN";
        recognition.onresult = function (event) {
          let result = "";
          for (let i = 0; i <= event.resultIndex; i++) {
            result += event.results[i][0].transcript;
          }
          textInp = result;
          area.value = textInp;
        };

        speekButton.addEventListener("click", function () {
          if (isGoing) {
            recognition.stop();
            isGoing = false;
          } else {
            recognition.start();
            isGoing = true;
          }
        });

        addTextButton.addEventListener("click", function () {
          let newItem = document.createElement("li");
          newItem.textContent = textInp;
          list.appendChild(newItem);
          textInp = "";
          area.value = "";
        });
      });
    </script>
  </body>
</html>
